<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0f172a">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>VoiceScribe AI</title>
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192.png">
    <link rel="apple-touch-icon" href="icons/icon-192.png">

    <!-- Tailwind CSS (ローカル) -->
    <script src="tailwind.js"></script>

    <!-- Phosphor Icons (ローカル) -->
    <script src="phosphor-icons.js"></script>

    <!-- Custom Styles -->
    <link rel="stylesheet" href="style.css">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['-apple-system', 'BlinkMacSystemFont', 'Segoe UI', 'Roboto', 'Helvetica Neue', 'Arial', 'sans-serif'],
                    },
                    colors: {
                        primary: {
                            50: '#eef2ff',
                            100: '#e0e7ff',
                            200: '#c7d2fe',
                            300: '#a5b4fc',
                            400: '#818cf8',
                            500: '#6366f1',
                            600: '#4f46e5',
                            700: '#4338ca',
                            800: '#3730a3',
                            900: '#312e81',
                        }
                    },
                    scale: {
                        '98': '0.98',
                    }
                }
            }
        }
    </script>
</head>

<body class="bg-slate-50 font-sans text-slate-800 min-h-screen overflow-x-hidden">

    <!-- ========================================== -->
    <!-- ===== HOME VIEW (デフォルト表示) ===== -->
    <!-- ========================================== -->
    <div id="homeView" class="min-h-screen">

        <!-- Header -->
        <header
            class="fixed top-0 left-0 right-0 z-50 px-5 py-4 bg-white/80 backdrop-blur-xl border-b border-white/20 shadow-sm">
            <div class="max-w-lg mx-auto flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div
                        class="w-10 h-10 rounded-xl bg-gradient-to-br from-primary-500 to-primary-600 flex items-center justify-center shadow-lg shadow-primary-500/30">
                        <i class="ph ph-waveform text-white text-xl"></i>
                    </div>
                    <div>
                        <h1 class="text-lg font-bold text-slate-900 tracking-tight">VoiceScribe</h1>
                        <p class="text-[10px] text-slate-400 font-medium tracking-wider uppercase">AI Transcription</p>
                    </div>
                </div>

                <!-- Settings Button -->
                <button id="openSettingsBtn"
                    class="relative p-3 rounded-2xl bg-slate-100 hover:bg-slate-200 active:scale-95 transition-all duration-200">
                    <i class="ph ph-gear-six text-xl text-slate-600"></i>
                    <span id="keywordBadge"
                        class="absolute -top-1 -right-1 min-w-5 h-5 px-1.5 rounded-full bg-primary-500 text-white text-[10px] font-bold flex items-center justify-center shadow-lg shadow-primary-500/40 hidden">0</span>
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="pt-24 pb-8 px-5">
            <div class="max-w-lg mx-auto">

                <!-- Hero Section: Recording Button -->
                <div class="flex flex-col items-center justify-center py-8 mb-6">
                    <div class="relative">
                        <!-- Pulse Rings -->
                        <div id="pulseRings" class="absolute inset-0 hidden">
                            <div class="absolute inset-0 rounded-full bg-red-400/30 animate-ping-slow"></div>
                            <div class="absolute inset-[-8px] rounded-full bg-red-400/20 animate-ping-slower"></div>
                            <div class="absolute inset-[-16px] rounded-full bg-red-400/10 animate-ping-slowest"></div>
                        </div>

                        <!-- Record Button -->
                        <button id="recordBtn"
                            class="relative z-10 w-24 h-24 rounded-full bg-gradient-to-br from-primary-500 to-primary-600 hover:from-primary-600 hover:to-primary-700 active:scale-95 transition-all duration-200 shadow-2xl shadow-primary-500/40 flex items-center justify-center group">
                            <i id="recordIcon"
                                class="ph ph-microphone text-4xl text-white group-hover:scale-110 transition-transform"></i>
                        </button>
                    </div>

                    <!-- Volume Meter -->
                    <div id="volumeMeterContainer"
                        class="hidden w-48 h-3 bg-slate-200 rounded-full overflow-hidden mt-4">
                        <div id="volumeMeter"
                            class="h-full bg-gradient-to-r from-green-400 to-emerald-500 rounded-full transition-all duration-75"
                            style="width: 0%"></div>
                    </div>

                    <!-- Status -->
                    <div class="flex items-center gap-2 mt-5">
                        <div id="statusDot" class="w-2 h-2 rounded-full bg-emerald-400 shadow-lg shadow-emerald-400/50">
                        </div>
                        <span id="statusText" class="text-sm font-medium text-slate-500">タップして録音開始</span>
                    </div>
                </div>

                <!-- History Section -->
                <div class="mb-4">
                    <div class="flex items-center justify-between mb-3">
                        <h2 class="text-lg font-bold text-slate-800">録音履歴</h2>
                        <span id="historyCount" class="text-sm text-slate-400">0件</span>
                    </div>

                    <!-- History List -->
                    <div id="historyList" class="space-y-3">
                        <!-- 履歴カードがここに動的生成される -->
                    </div>

                    <!-- Empty State -->
                    <div id="emptyHistory" class="py-12 text-center">
                        <div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-slate-100 flex items-center justify-center">
                            <i class="ph ph-microphone-slash text-3xl text-slate-300"></i>
                        </div>
                        <p class="text-slate-400 font-medium">録音履歴がありません</p>
                        <p class="text-slate-300 text-sm mt-1">上のボタンをタップして録音を開始</p>
                    </div>
                </div>

            </div>
        </main>
    </div>

    <!-- ========================================== -->
    <!-- ===== DETAIL VIEW (詳細閲覧画面) ===== -->
    <!-- ========================================== -->
    <div id="detailView"
        class="fixed inset-0 z-[60] bg-slate-50 translate-x-full transition-transform duration-300 ease-out">

        <!-- Detail Header -->
        <header
            class="fixed top-0 left-0 right-0 z-10 px-4 py-3 bg-white/90 backdrop-blur-xl border-b border-slate-100 shadow-sm">
            <div class="max-w-lg mx-auto flex items-center gap-3">
                <button id="backBtn"
                    class="p-2 -ml-2 rounded-xl hover:bg-slate-100 active:scale-95 transition-all duration-200">
                    <i class="ph ph-caret-left text-2xl text-slate-600"></i>
                </button>
                <div class="flex-1 min-w-0">
                    <h2 id="detailTitle" class="text-base font-bold text-slate-900 truncate">録音詳細</h2>
                    <p id="detailDate" class="text-xs text-slate-400">2024/01/17 10:00</p>
                </div>
                <button id="deleteCurrentBtn"
                    class="p-2 rounded-xl hover:bg-red-50 active:scale-95 transition-all duration-200 group">
                    <i class="ph ph-trash text-xl text-slate-400 group-hover:text-red-500"></i>
                </button>
            </div>
        </header>

        <!-- Detail Content -->
        <main class="pt-20 pb-28 px-5 h-full overflow-y-auto">
            <div class="max-w-lg mx-auto">
                <div class="bg-white rounded-2xl p-5 shadow-sm border border-slate-100">
                    <p id="detailFullText" class="text-base leading-relaxed text-slate-700 whitespace-pre-wrap"></p>
                </div>
            </div>
        </main>

        <!-- Detail Action Bar -->
        <div
            class="fixed bottom-0 left-0 right-0 z-10 px-5 py-4 bg-white/90 backdrop-blur-xl border-t border-slate-100">
            <div class="max-w-lg mx-auto flex items-center gap-3">
                <button id="detailCopyBtn"
                    class="flex-1 flex items-center justify-center gap-2 py-3.5 rounded-xl bg-slate-100 hover:bg-slate-200 active:scale-98 transition-all duration-200">
                    <i class="ph ph-copy text-lg text-slate-600"></i>
                    <span class="text-sm font-semibold text-slate-700">全文コピー</span>
                </button>
                <button id="detailSaveBtn"
                    class="flex-1 flex items-center justify-center gap-2 py-3.5 rounded-xl bg-primary-500 hover:bg-primary-600 active:scale-98 transition-all duration-200 shadow-lg shadow-primary-500/30">
                    <i class="ph ph-file-text text-lg text-white"></i>
                    <span class="text-sm font-semibold text-white">TXT保存</span>
                </button>
            </div>
        </div>
    </div>

    <!-- ========================================== -->
    <!-- ===== BOTTOM SHEET (設定) ===== -->
    <!-- ========================================== -->
    <div id="bottomSheetOverlay"
        class="fixed inset-0 bg-black/40 backdrop-blur-sm z-[70] opacity-0 pointer-events-none transition-opacity duration-300">
    </div>

    <div id="bottomSheet"
        class="fixed inset-x-0 bottom-0 z-[70] translate-y-full transition-transform duration-500 ease-out">
        <div class="bg-white rounded-t-3xl shadow-2xl shadow-slate-900/30 max-h-[85vh] flex flex-col">

            <!-- Handle Bar -->
            <div class="flex justify-center pt-3 pb-2">
                <div class="w-10 h-1 rounded-full bg-slate-300"></div>
            </div>

            <!-- Sheet Header -->
            <div class="flex items-center justify-between px-6 py-4 border-b border-slate-100">
                <div>
                    <h2 class="text-xl font-bold text-slate-900">キーワード管理</h2>
                    <p class="text-sm text-slate-400 mt-0.5">認識精度を向上させる単語を登録</p>
                </div>
                <button id="closeSheetBtn"
                    class="p-2.5 rounded-xl bg-slate-100 hover:bg-slate-200 active:scale-95 transition-all duration-200">
                    <i class="ph ph-x text-xl text-slate-500"></i>
                </button>
            </div>

            <!-- Keyword List -->
            <div class="flex-1 overflow-y-auto px-6 py-4 min-h-[200px] max-h-[400px]">
                <div id="keywordList" class="space-y-3"></div>
                <div id="emptyKeywords" class="hidden py-12 text-center">
                    <div class="w-16 h-16 mx-auto mb-4 rounded-2xl bg-slate-100 flex items-center justify-center">
                        <i class="ph ph-note-blank text-3xl text-slate-300"></i>
                    </div>
                    <p class="text-slate-400 font-medium">登録されたキーワードがありません</p>
                    <p class="text-slate-300 text-sm mt-1">下の入力欄から追加してください</p>
                </div>
            </div>

            <!-- Input Bar -->
            <div class="px-4 py-4 bg-slate-50 border-t border-slate-100 safe-area-bottom">
                <div class="flex items-center gap-3">
                    <div class="flex-1 relative">
                        <input type="text" id="keywordInput" placeholder="新しいキーワードを入力..."
                            class="w-full px-5 py-3.5 bg-white rounded-2xl border-2 border-slate-200 focus:border-primary-400 focus:ring-4 focus:ring-primary-100 outline-none text-slate-700 placeholder:text-slate-300 transition-all duration-200">
                    </div>
                    <button id="addKeywordBtn"
                        class="p-3.5 rounded-2xl bg-primary-500 hover:bg-primary-600 active:scale-95 transition-all duration-200 shadow-lg shadow-primary-500/30">
                        <i class="ph ph-plus text-xl text-white"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ========================================== -->
    <!-- ===== TOAST NOTIFICATION ===== -->
    <!-- ========================================== -->
    <div id="toast"
        class="fixed top-20 left-1/2 -translate-x-1/2 z-[100] opacity-0 -translate-y-4 pointer-events-none transition-all duration-300">
        <div
            class="px-5 py-3 bg-slate-900 text-white text-sm font-medium rounded-2xl shadow-xl flex items-center gap-2">
            <i id="toastIcon" class="ph ph-check-circle text-lg text-emerald-400"></i>
            <span id="toastMessage">操作が完了しました</span>
        </div>
    </div>

    <script src="main.js"></script>
</body>

</html>